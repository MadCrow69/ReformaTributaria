<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DiagnÃ³stico Reforma TributÃ¡ria</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      color: #333;
    }

    header {
      background-color: #004080;
      color: white;
      padding: 2rem;
      text-align: center;
    }

    main {
      max-width: 900px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.05);
    }

    h2 {
      color: #004080;
      margin-top: 2rem;
    }

    label {
      display: block;
      margin: 1rem 0 0.5rem;
      font-weight: bold;
    }

    input, select, textarea {
      width: 100%;
      padding: 0.7rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    .inline-options {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .inline-options label {
      font-weight: normal;
    }

    .button {
      background-color: #004080;
      color: white;
      border: none;
      padding: 1rem 2rem;
      margin-top: 2rem;
      font-size: 1rem;
      border-radius: 10px;
      cursor: pointer;
    }

    .button:hover {
      background-color: #003060;
    }

    .success {
      color: green;
      margin-top: 1rem;
    }

    .error {
      color: red;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ“ DiagnÃ³stico de Impacto da Reforma TributÃ¡ria</h1>
    <p>Forbiz | Evento Especial</p>
  </header>
  <main>
    <!-- Somente o trecho do formulÃ¡rio alterado -->
<form id="diagnosticoForm">
    <h2>1. Dados da empresa</h2>
    <label>ğŸ“› RazÃ£o social:</label><input type="text" name="razao_social" required value="Forbiz SoluÃ§Ãµes Ltda">
    <label>ğŸ¢ CNPJ:</label><input type="text" name="cnpj" required value="12.345.678/0001-90">
    <label>ğŸŒ Website:</label><input type="url" name="website" value="https://www.forbiz.com.br">
    <label>ğŸ“ Cidade e Estado (Matriz):</label><input type="text" name="cidade_estado" value="SÃ£o Paulo - SP">
    <label>ğŸ‘¤ ResponsÃ¡vel:</label><input type="text" name="responsavel" value="Carlos Silva">
    <label>ğŸ“§ E-mail:</label><input type="email" name="email" value="carlos@forbiz.com.br">
    <label>ğŸ“ Telefone/WhatsApp:</label><input type="text" name="telefone" value="(11) 91234-5678">
  
    <h2>2. Estrutura e regime fiscal</h2>
    <label>ğŸ’¼ Setor principal:</label>
    <select name="setor">
      <option>IndÃºstria</option>
      <option selected>ComÃ©rcio</option>
      <option>ServiÃ§os</option>
      <option>AgropecuÃ¡ria</option>
      <option>Outro</option>
    </select>
    <label>ğŸ’¸ Regime tributÃ¡rio:</label>
    <select name="regime">
      <option selected>Simples Nacional</option>
      <option>Lucro Presumido</option>
      <option>Lucro Real</option>
    </select>
    <label>ğŸ§¾ MÃ©dia de faturamento:</label>
    <select name="faturamento">
      <option>AtÃ© R$ 4,8 milhÃµes</option>
      <option selected>R$ 4,8 mi a R$ 78 mi</option>
      <option>Acima de R$ 78 milhÃµes</option>
    </select>
    <label>ğŸ­ Opera em mais de um estado?</label>
    <select name="multiestado"><option>Sim</option><option selected>NÃ£o</option></select>
    <label>ğŸ” SubstituiÃ§Ã£o tributÃ¡ria ou benefÃ­cios?</label>
    <select name="beneficios"><option selected>Sim</option><option>NÃ£o</option><option>NÃ£o sei</option></select>
    <label>ğŸ§® Produtos com isenÃ§Ã£o ou alÃ­quota zero?</label>
    <select name="isenÃ§Ã£o"><option>Sim</option><option selected>NÃ£o</option><option>NÃ£o sei</option></select>
  
    <h2>3. OperaÃ§Ãµes e riscos</h2>
    <label>ğŸ” JÃ¡ iniciou estudo sobre CBS/IBS?</label><select name="estudo"><option selected>Sim</option><option>NÃ£o</option></select>
    <label>ğŸ“‰ Usa crÃ©ditos de PIS/COFINS?</label><select name="creditos"><option selected>Sim</option><option>NÃ£o</option><option>NÃ£o sei</option></select>
    <label>âš–ï¸ Contratos com clÃ¡usulas de revisÃ£o?</label>
    <select name="clausulas"><option>Sim</option><option selected>NÃ£o</option><option>Parcialmente</option></select>
  
    <label>ğŸ“¦ Informe atÃ© 5 NCMs com descriÃ§Ã£o:</label>
    <div id="ncms">
      <input type="text" placeholder="NCM 1 â€“ Produto" name="ncm1" value="8501.10.19 â€“ Motor elÃ©trico">
      <input type="text" placeholder="NCM 2 â€“ Produto" name="ncm2" value="8414.59.90 â€“ Compressor de ar">
      <input type="text" placeholder="NCM 3 â€“ Produto" name="ncm3" value="8471.30.12 â€“ Impressora tÃ©rmica">
      <input type="text" placeholder="NCM 4 â€“ Produto" name="ncm4" value="8536.69.10 â€“ Tomada elÃ©trica">
      <input type="text" placeholder="NCM 5 â€“ Produto" name="ncm5" value="8544.42.00 â€“ Cabo de energia">
    </div>
  
    <label>ğŸ“ˆ AvaliaÃ§Ã£o da carga tributÃ¡ria:</label>
    <select name="carga">
      <option selected>Muito elevada (acima de 20%)</option>
      <option>Elevada (15% a 20%)</option>
      <option>Moderada (10% a 15%)</option>
      <option>Baixa (atÃ© 10%)</option>
      <option>NÃ£o sei informar</option>
    </select>
    <label>ğŸ’¼ Contabilidade:</label>
    <select name="contabilidade"><option selected>Terceiriza</option><option>Equipe interna</option><option>Misto</option></select>
  
    <h2>4. ObrigaÃ§Ãµes acessÃ³rias e tecnologia</h2>
    <label>ğŸ§  Equipe preparada?</label><select name="preparacao"><option selected>Sim</option><option>NÃ£o</option><option>Parcialmente</option></select>
    <label>ğŸ–¥ï¸ Sistema ERP:</label>
    <select name="erp">
      <option selected>SENIOR SISTEMAS</option>
      <option>Outros</option>
      <option>Nenhum</option>
    </select>
    <label>ğŸ”§ Pretende atualizar o sistema?</label><select name="atualizar_sistema"><option selected>Sim</option><option>NÃ£o</option><option>Ainda nÃ£o avaliado</option></select>
    <label>ğŸ“‘ ApuraÃ§Ã£o de tributos:</label>
    <select name="apuracao"><option>Manual (Excel)</option><option selected>SemiautomÃ¡tica</option><option>Totalmente automatizada</option></select>
    <label>ğŸ“‚ HistÃ³rico de crÃ©ditos?</label><select name="historico"><option selected>Sim</option><option>NÃ£o</option><option>Parcialmente</option></select>
    <label>ğŸ¤ Deseja relatÃ³rio gratuito?</label><select name="relatorio"><option selected>Sim, quero receber</option><option>NÃ£o tenho interesse</option></select>
  
    <button type="submit" class="button">Enviar DiagnÃ³stico</button>
    <div id="responseMsg"></div>
  </form>
  
  </main>

  <script>
    const form = document.getElementById('diagnosticoForm');
    const responseMsg = document.getElementById('responseMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        empresa: {
          razao_social: form.razao_social.value,
          cnpj: form.cnpj.value,
          website: form.website.value,
          cidade_estado: form.cidade_estado.value,
          responsavel: form.responsavel.value,
          email: form.email.value,
          telefone: form.telefone.value
        },
        estrutura_fiscal: {
          setor: form.setor.value,
          regime_tributario: form.regime.value,
          faturamento: form.faturamento.value,
          opera_em_outros_estados: form.multiestado.value,
          tem_regimes_especiais: form.beneficios.value,
          tem_produtos_isencao: form.isenÃ§Ã£o.value
        },
        operacoes_riscos: {
          estudo_cbs_ibs: form.estudo.value,
          utiliza_creditos_pis_cofins: form.creditos.value,
          clausulas_revisao: form.clausulas.value,
          ncms: [
            { codigo: form.ncm1.value.split("â€“")[0]?.trim(), produto: form.ncm1.value.split("â€“")[1]?.trim() },
            { codigo: form.ncm2.value.split("â€“")[0]?.trim(), produto: form.ncm2.value.split("â€“")[1]?.trim() },
            { codigo: form.ncm3.value.split("â€“")[0]?.trim(), produto: form.ncm3.value.split("â€“")[1]?.trim() },
            { codigo: form.ncm4.value.split("â€“")[0]?.trim(), produto: form.ncm4.value.split("â€“")[1]?.trim() },
            { codigo: form.ncm5.value.split("â€“")[0]?.trim(), produto: form.ncm5.value.split("â€“")[1]?.trim() },
          ],
          avaliacao_carga: form.carga.value,
          tipo_contabilidade: form.contabilidade.value
        },
        obrigacoes_tecnologia: {
          equipe_preparada: form.preparacao.value,
          erp: form.erp.value,
          atualizacao_sistema: form.atualizar_sistema.value,
          apuracao_tributos: form.apuracao.value,
          historico_creditos: form.historico.value,
          quer_relatorio: form.relatorio.value
        }
      };

      try {
        const res = await fetch('http://201.11.9.158:3375/reformatributaria', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (res.ok) {
          responseMsg.innerHTML = '<p class="success">âœ… DiagnÃ³stico enviado com sucesso!</p>';
          form.reset();
        } else {
          throw new Error('Erro ao enviar');
        }
      } catch (err) {
        responseMsg.innerHTML = '<p class="error">âŒ Ocorreu um erro no envio. Tente novamente.</p>';
      }
    });
  </script>
</body>
</html>
